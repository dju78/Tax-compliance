function _(s){const e=s.split(/\r?\n/).filter(i=>i.trim().length>0);if(e.length===0)return{headers:[],rows:[]};const d=e[0].includes(";")?";":",",c=i=>{const u=[];let o="",f=!1;for(let t=0;t<i.length;t++){const a=i[t];f?a==='"'?t+1<i.length&&i[t+1]==='"'?(o+='"',t++):f=!1:o+=a:a==='"'?f=!0:a===d?(u.push(o.trim()),o=""):o+=a}return u.push(o.trim()),u},r=c(e[0]),m=e.slice(1).map(c);return{headers:r,rows:m}}function b(s,e,n,d){const c=[],r=t=>t?e.indexOf(t):-1,m=r(n.date),i=r(n.description),u=r(n.amount),o=r(n.moneyIn),f=r(n.moneyOut);return s.forEach(t=>{if(t.length!==e.length)return;const a=t[m],I=t[i];if(!a||!I)return;const h=y(a);if(!h)return;let l=0;if(u!==-1)l=p(t[u]);else if(o!==-1&&f!==-1){const x=p(t[o]),g=p(t[f]);g>0?l=-Math.abs(g):l=Math.abs(x)}isNaN(l)||l===0||c.push({id:crypto.randomUUID(),company_id:d,date:h,description:I,amount:l,is_business:!0,dla_status:"none",tax_year_label:h.getFullYear().toString(),category_name:l>0?"Uncategorized Income":"Uncategorized Expense"})}),c}function y(s){let e=new Date(s);if(!isNaN(e.getTime()))return e;const n=s.split(/[\/\-\.]/);if(n.length===3){const d=parseInt(n[0],10),c=parseInt(n[1],10)-1,r=parseInt(n[2],10);if(e=new Date(r,c,d),!isNaN(e.getTime()))return e}return null}function p(s){if(!s)return 0;const e=s.replace(/[^\d.-]/g,"");return parseFloat(e)||0}export{b as mapRowsToTransactions,_ as parseCSV};
